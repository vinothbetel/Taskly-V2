import{o as W,Q as rs,V as qe,r as n,j as e,T as as,O as Ge,W as Ye,Y as ns,C as Be,Z as ls,p as is,q as os,a as We,P as Je,_ as cs,s as Qe,e as M,$ as Ze,a0 as ie,B as P,X as et,g as ds,E as us,F as ms,G as hs,a1 as Ce,a2 as De,a3 as Se,a4 as Y,a5 as pe,t as Te,x as fs,a6 as ps,u as xs,a7 as gs,I as me,a8 as vs,a9 as tt,H as K,aa as st,ab as rt,M as at,l as fe,U as nt,ac as re,ad as J,ae as le,J as ys,K as js,L as bs,N as ws,af as Ns,ag as Z}from"./index-Ct4co2uw.js";import{S as Cs,a as Ds,u as Ss}from"./useTouchGestures-Bc9s-WLy.js";import{T as lt}from"./textarea-BU_l988q.js";import{t as V,c as Ts,e as Es,g as _e,m as Fe,a as de,b as As}from"./en-US-DSSwd-Ay.js";import{e as Ms,d as Rs}from"./endOfMonth-BNqLjwTF.js";import{M as Ps,i as Is,u as it,P as ks,a as $s,b as _s,L as Fs,m as ot}from"./proxy-TuWvY4c6.js";import{C as Os}from"./checkbox-BP5Za_8b.js";import{C as Ls,e as zs,S as Oe,a as Le,b as ze,c as Ke,d as ee}from"./select-BcIKfmdZ.js";import{P as Ks}from"./plus-BDpGtQ6S.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],Hs=W("chevrons-up-down",Vs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ee=W("circle-check",Us);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],ct=W("ellipsis-vertical",Xs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Gs=W("ellipsis",qs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Ae=W("message-circle",Ys);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Me=W("square-pen",Bs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]],dt=W("star-off",Ws);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ut=W("star",Js);var mt="AlertDialog",[Qs,ca]=rs(mt,[qe]),G=qe(),ht=t=>{const{__scopeAlertDialog:s,...r}=t,l=G(s);return e.jsx(Qe,{...l,...r,modal:!0})};ht.displayName=mt;var Zs="AlertDialogTrigger",er=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...l}=t,a=G(r);return e.jsx(as,{...a,...l,ref:s})});er.displayName=Zs;var tr="AlertDialogPortal",ft=t=>{const{__scopeAlertDialog:s,...r}=t,l=G(s);return e.jsx(Je,{...l,...r})};ft.displayName=tr;var sr="AlertDialogOverlay",pt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...l}=t,a=G(r);return e.jsx(Ge,{...a,...l,ref:s})});pt.displayName=sr;var ae="AlertDialogContent",[rr,ar]=Qs(ae),nr=cs("AlertDialogContent"),xt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,children:l,...a}=t,i=G(r),d=n.useRef(null),h=Ye(s,d),m=n.useRef(null);return e.jsx(ns,{contentName:ae,titleName:gt,docsSlug:"alert-dialog",children:e.jsx(rr,{scope:r,cancelRef:m,children:e.jsxs(Be,{role:"alertdialog",...i,...a,ref:h,onOpenAutoFocus:ls(a.onOpenAutoFocus,c=>{var u;c.preventDefault(),(u=m.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:c=>c.preventDefault(),onInteractOutside:c=>c.preventDefault(),children:[e.jsx(nr,{children:l}),e.jsx(ir,{contentRef:d})]})})})});xt.displayName=ae;var gt="AlertDialogTitle",vt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...l}=t,a=G(r);return e.jsx(is,{...a,...l,ref:s})});vt.displayName=gt;var yt="AlertDialogDescription",jt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...l}=t,a=G(r);return e.jsx(os,{...a,...l,ref:s})});jt.displayName=yt;var lr="AlertDialogAction",bt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...l}=t,a=G(r);return e.jsx(We,{...a,...l,ref:s})});bt.displayName=lr;var wt="AlertDialogCancel",Nt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...l}=t,{cancelRef:a}=ar(wt,r),i=G(r),d=Ye(s,a);return e.jsx(We,{...i,...l,ref:d})});Nt.displayName=wt;var ir=({contentRef:t})=>{const s=`\`${ae}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${ae}\` by passing a \`${yt}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${ae}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return n.useEffect(()=>{var l;document.getElementById((l=t.current)==null?void 0:l.getAttribute("aria-describedby"))||console.warn(s)},[s,t]),null},or=ht,cr=ft,Ct=pt,Dt=xt,St=bt,Tt=Nt,Et=vt,At=jt;const dr=or,ur=cr,Mt=n.forwardRef(({className:t,...s},r)=>e.jsx(Ct,{className:M("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:r}));Mt.displayName=Ct.displayName;const Rt=n.forwardRef(({className:t,...s},r)=>e.jsxs(ur,{children:[e.jsx(Mt,{}),e.jsx(Dt,{ref:r,className:M("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s})]}));Rt.displayName=Dt.displayName;const Pt=({className:t,...s})=>e.jsx("div",{className:M("flex flex-col space-y-2 text-center sm:text-left",t),...s});Pt.displayName="AlertDialogHeader";const It=({className:t,...s})=>e.jsx("div",{className:M("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});It.displayName="AlertDialogFooter";const kt=n.forwardRef(({className:t,...s},r)=>e.jsx(Et,{ref:r,className:M("text-lg font-semibold",t),...s}));kt.displayName=Et.displayName;const $t=n.forwardRef(({className:t,...s},r)=>e.jsx(At,{ref:r,className:M("text-sm text-muted-foreground",t),...s}));$t.displayName=At.displayName;const _t=n.forwardRef(({className:t,...s},r)=>e.jsx(St,{ref:r,className:M(Ze(),t),...s}));_t.displayName=St.displayName;const Ft=n.forwardRef(({className:t,...s},r)=>e.jsx(Tt,{ref:r,className:M(Ze({variant:"outline"}),"mt-2 sm:mt-0",t),...s}));Ft.displayName=Tt.displayName;function Ot({open:t,onOpenChange:s,onConfirm:r,title:l="Delete Task",description:a="Are you sure you want to delete this task? This action cannot be undone.",itemName:i}){return e.jsx(dr,{open:t,onOpenChange:s,children:e.jsxs(Rt,{className:"sm:max-w-md",children:[e.jsxs(Pt,{children:[e.jsx(kt,{className:"flex items-center gap-2",children:l}),e.jsx($t,{children:i?e.jsxs(e.Fragment,{children:['Are you sure you want to delete "',e.jsx("strong",{children:i}),'"? This action cannot be undone.']}):a})]}),e.jsxs(It,{children:[e.jsx(Ft,{children:"Cancel"}),e.jsx(_t,{onClick:r,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})}function Lt({taskId:t,initialContent:s="",isEditing:r=!1,commentId:l,onCommentAdded:a,onCancel:i}){const{addComment:d,updateComment:h}=ie(),[m,c]=n.useState(s),[u,p]=n.useState(!1),f=1e3,y=f-m.length,v=async x=>{if(x.preventDefault(),!(!m.trim()||u)){p(!0);try{r&&l?await h(l,t,m):await d(t,m),c(""),a==null||a()}catch(A){console.error("Error submitting comment:",A)}finally{p(!1)}}},S=x=>{x.key==="Enter"&&(x.ctrlKey||x.metaKey)&&(x.preventDefault(),v(x)),x.key==="Escape"&&(i==null||i())};return e.jsxs("form",{onSubmit:v,className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(lt,{value:m,onChange:x=>c(x.target.value),onKeyDown:S,placeholder:"Add a comment... (Ctrl+Enter to submit)",className:"min-h-[80px] resize-none pr-16",maxLength:f,autoFocus:!0}),e.jsx("div",{className:"absolute bottom-2 right-2 text-xs text-muted-foreground",children:y})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-muted-foreground"}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsxs(P,{type:"button",variant:"ghost",size:"sm",onClick:i,disabled:u,children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),"Cancel"]}),e.jsxs(P,{type:"submit",size:"sm",disabled:!m.trim()||u||y<0,children:[e.jsx(Cs,{className:"h-4 w-4 mr-1"}),u?"Posting...":r?"Update":"Comment"]})]})]})]})}function he(t,s){const r=V(t),l=V(s),a=r.getTime()-l.getTime();return a<0?-1:a>0?1:a}function mr(t){return Ts(t,Date.now())}function hr(t){return s=>{const l=(t?Math[t]:Math.trunc)(s);return l===0?0:l}}function fr(t,s){return+V(t)-+V(s)}function pr(t){const s=V(t);return s.setHours(23,59,59,999),s}function xr(t){const s=V(t);return+pr(s)==+Ms(s)}function gr(t,s){const r=V(t),l=V(s),a=he(r,l),i=Math.abs(Rs(r,l));let d;if(i<1)d=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*i);let h=he(r,l)===-a;xr(V(t))&&i===1&&he(t,l)===1&&(h=!1),d=a*(i-Number(h))}return d===0?0:d}function vr(t,s,r){const l=fr(t,s)/1e3;return hr(r==null?void 0:r.roundingMethod)(l)}function yr(t,s,r){const l=As(),a=(r==null?void 0:r.locale)??l.locale??Es,i=2520,d=he(t,s);if(isNaN(d))throw new RangeError("Invalid time value");const h=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:d});let m,c;d>0?(m=V(s),c=V(t)):(m=V(t),c=V(s));const u=vr(c,m),p=(_e(c)-_e(m))/1e3,f=Math.round((u-p)/60);let y;if(f<2)return r!=null&&r.includeSeconds?u<5?a.formatDistance("lessThanXSeconds",5,h):u<10?a.formatDistance("lessThanXSeconds",10,h):u<20?a.formatDistance("lessThanXSeconds",20,h):u<40?a.formatDistance("halfAMinute",0,h):u<60?a.formatDistance("lessThanXMinutes",1,h):a.formatDistance("xMinutes",1,h):f===0?a.formatDistance("lessThanXMinutes",1,h):a.formatDistance("xMinutes",f,h);if(f<45)return a.formatDistance("xMinutes",f,h);if(f<90)return a.formatDistance("aboutXHours",1,h);if(f<Fe){const v=Math.round(f/60);return a.formatDistance("aboutXHours",v,h)}else{if(f<i)return a.formatDistance("xDays",1,h);if(f<de){const v=Math.round(f/Fe);return a.formatDistance("xDays",v,h)}else if(f<de*2)return y=Math.round(f/de),a.formatDistance("aboutXMonths",y,h)}if(y=gr(c,m),y<12){const v=Math.round(f/de);return a.formatDistance("xMonths",v,h)}else{const v=y%12,S=Math.trunc(y/12);return v<3?a.formatDistance("aboutXYears",S,h):v<9?a.formatDistance("overXYears",S,h):a.formatDistance("almostXYears",S+1,h)}}function jr(t,s){return yr(t,mr(t),s)}function br({comment:t}){const{deleteComment:s}=ie(),{user:r}=ds(),[l,a]=n.useState(!1),i=(r==null?void 0:r.uid)===t.userId,d=f=>{if(!f)return"";const y=f.toDate?f.toDate():new Date(f),v=jr(y,{addSuffix:!0});return v.includes("less than a minute")?"Just now":v.includes("about a minute")?"1 minute ago":v},h=f=>f.split(" ").map(y=>y[0]).join("").toUpperCase().slice(0,2),m=()=>{a(!0)},c=async()=>{confirm("Are you sure you want to delete this comment?")&&await s(t.id,t.taskId)},u=()=>{a(!1)},p=()=>{a(!1)};return l?e.jsx("div",{className:"border rounded-lg p-3 bg-muted/20",children:e.jsx(Lt,{taskId:t.taskId,initialContent:t.content,isEditing:!0,commentId:t.id,onCommentAdded:u,onCancel:p})}):e.jsxs("div",{className:"flex gap-3 group",children:[e.jsxs(us,{className:"h-8 w-8 flex-shrink-0",children:[e.jsx(ms,{src:t.userPhotoURL,alt:t.userDisplayName}),e.jsx(hs,{className:"text-xs",children:h(t.userDisplayName)})]}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:t.userDisplayName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:d(t.createdAt)}),t.isEdited&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"(edited)"}),i&&e.jsxs(Ce,{children:[e.jsx(De,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Gs,{className:"h-3 w-3"})})}),e.jsxs(Se,{align:"end",children:[e.jsxs(Y,{onClick:m,children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(Y,{onClick:c,className:"text-destructive",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),e.jsx("div",{className:"text-sm whitespace-pre-wrap break-words",children:t.content})]})]})}class wr extends n.Component{getSnapshotBeforeUpdate(s){const r=this.props.childRef.current;if(r&&s.isPresent&&!this.props.isPresent){const l=r.offsetParent,a=Is(l)&&l.offsetWidth||0,i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft,i.right=a-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Nr({children:t,isPresent:s,anchorX:r,root:l}){const a=n.useId(),i=n.useRef(null),d=n.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:h}=n.useContext(Ps);return n.useInsertionEffect(()=>{const{width:m,height:c,top:u,left:p,right:f}=d.current;if(s||!i.current||!m||!c)return;const y=r==="left"?`left: ${p}`:`right: ${f}`;i.current.dataset.motionPopId=a;const v=document.createElement("style");h&&(v.nonce=h);const S=l??document.head;return S.appendChild(v),v.sheet&&v.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${m}px !important;
            height: ${c}px !important;
            ${y}px !important;
            top: ${u}px !important;
          }
        `),()=>{S.contains(v)&&S.removeChild(v)}},[s]),e.jsx(wr,{isPresent:s,childRef:i,sizeRef:d,children:n.cloneElement(t,{ref:i})})}const Cr=({children:t,initial:s,isPresent:r,onExitComplete:l,custom:a,presenceAffectsLayout:i,mode:d,anchorX:h,root:m})=>{const c=it(Dr),u=n.useId();let p=!0,f=n.useMemo(()=>(p=!1,{id:u,initial:s,isPresent:r,custom:a,onExitComplete:y=>{c.set(y,!0);for(const v of c.values())if(!v)return;l&&l()},register:y=>(c.set(y,!1),()=>c.delete(y))}),[r,c,l]);return i&&p&&(f={...f}),n.useMemo(()=>{c.forEach((y,v)=>c.set(v,!1))},[r]),n.useEffect(()=>{!r&&!c.size&&l&&l()},[r]),d==="popLayout"&&(t=e.jsx(Nr,{isPresent:r,anchorX:h,root:m,children:t})),e.jsx(ks.Provider,{value:f,children:t})};function Dr(){return new Map}const ue=t=>t.key||"";function Ve(t){const s=[];return n.Children.forEach(t,r=>{n.isValidElement(r)&&s.push(r)}),s}const zt=({children:t,custom:s,initial:r=!0,onExitComplete:l,presenceAffectsLayout:a=!0,mode:i="sync",propagate:d=!1,anchorX:h="left",root:m})=>{const[c,u]=$s(d),p=n.useMemo(()=>Ve(t),[t]),f=d&&!c?[]:p.map(ue),y=n.useRef(!0),v=n.useRef(p),S=it(()=>new Map),[x,A]=n.useState(p),[F,H]=n.useState(p);_s(()=>{y.current=!1,v.current=p;for(let b=0;b<F.length;b++){const N=ue(F[b]);f.includes(N)?S.delete(N):S.get(N)!==!0&&S.set(N,!1)}},[F,f.length,f.join("-")]);const R=[];if(p!==x){let b=[...p];for(let N=0;N<F.length;N++){const O=F[N],X=ue(O);f.includes(X)||(b.splice(N,0,O),R.push(O))}return i==="wait"&&R.length&&(b=R),H(Ve(b)),A(p),null}const{forceRender:I}=n.useContext(Fs);return e.jsx(e.Fragment,{children:F.map(b=>{const N=ue(b),O=d&&!c?!1:p===F||f.includes(N),X=()=>{if(S.has(N))S.set(N,!0);else return;let C=!0;S.forEach(w=>{w||(C=!1)}),C&&(I==null||I(),H(v.current),d&&(u==null||u()),l&&l())};return e.jsx(Cr,{isPresent:O,initial:!y.current||r?void 0:!1,custom:s,presenceAffectsLayout:a,mode:i,root:m,onExitComplete:O?void 0:X,anchorX:h,children:b},N)})})};function Kt({taskId:t,className:s,isExpanded:r,onToggleExpanded:l}){const{comments:a,commentCounts:i,loading:d,subscribeToTaskComments:h,unsubscribeFromTaskComments:m}=ie(),[c,u]=n.useState(!1),p=n.useRef(null),f=a[t]||[];i[t];const y=d[t]===!0&&f.length===0;n.useEffect(()=>{p.current&&clearTimeout(p.current);const S=h(t);return()=>{S&&m(t)}},[t,h,m]),n.useEffect(()=>{r?p.current&&(clearTimeout(p.current),p.current=null):p.current=setTimeout(()=>{m(t)},3e4)},[r,t,m]);const v=()=>{u(!1)};return e.jsx("div",{className:M("w-full pt-0",s),children:e.jsx(zt,{initial:!1,children:r&&e.jsx(ot.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"spring",duration:.4,bounce:0},className:"overflow-hidden",children:e.jsx(Te,{className:"mt-1 border-none shadow-none bg-transparent",children:e.jsxs(fs,{className:"py-1 px-2 space-y-3",children:[" ",c?e.jsx(Lt,{taskId:t,onCommentAdded:v,onCancel:()=>u(!1)}):e.jsxs(P,{variant:"outline",onClick:()=>u(!0),className:"w-full justify-start text-muted-foreground h-9 rounded-md border-dashed hover:border-primary/50 hover:text-primary transition-colors",size:"sm",children:[e.jsx(Ae,{className:"h-3 w-3 mr-2"}),"Write a comment..."]}),y?e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground py-4",children:[e.jsx(ps,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Loading comments..."})]}):f.length>0&&e.jsxs("div",{className:"space-y-3 border-t border-border/50 pt-2",children:[" ",f.map(S=>e.jsx(br,{comment:S},S.id))]})]})})})})})}const Sr=t=>{if(!t||t.length===0)return 0;const s=t.filter(r=>r.isCompleted).length;return Math.round(s/t.length*100)};function Vt({task:t}){var S;const{addSubtask:s,toggleSubtaskStatus:r,deleteSubtask:l}=xs(),[a,i]=n.useState(""),[d,h]=n.useState(!1),m=Sr(t.subtasks),c=((S=t.subtasks)==null?void 0:S.length)||0,u=async x=>{x.stopPropagation(),a.trim()&&(await s(t.id,a.trim()),i(""))},p=async(x,A)=>{await r(t.id,A)},f=async(x,A)=>{x.stopPropagation(),confirm("Are you sure you want to delete this subtask?")&&await l(t.id,A)},y=x=>{x.stopPropagation(),x.key==="Enter"&&(x.preventDefault(),u(x))},v=()=>{h(!d)};return e.jsxs("div",{className:"pt-0 pb-3 space-y-3",children:[" ",e.jsxs(P,{variant:"ghost",onClick:v,className:"w-full justify-between py-1 px-2 h-auto hover:bg-muted/30 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["Subtasks ",c>0&&`(${c})`]})]}),d?e.jsx(Ls,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(zs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(zt,{initial:!1,children:d&&e.jsx(ot.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"spring",duration:.4,bounce:0},className:"overflow-hidden",children:e.jsxs("div",{className:"space-y-3 pt-0",children:[t.subtasks&&t.subtasks.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gs,{value:m,className:"flex-1 h-2"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[m,"%"]})]}),e.jsx("div",{className:"space-y-2",children:t.subtasks.map(x=>e.jsxs("div",{className:"flex items-center gap-2 group",children:[e.jsx(Os,{id:`subtask-${x.id}`,checked:x.isCompleted,onCheckedChange:A=>p({stopPropagation:()=>{}},x.id),onClick:A=>A.stopPropagation(),className:"h-4 w-4"}),e.jsx("label",{htmlFor:`subtask-${x.id}`,className:M("flex-1 text-sm cursor-pointer",x.isCompleted?"line-through text-muted-foreground":"text-foreground"),onClick:A=>A.stopPropagation(),children:x.title}),e.jsx(P,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity hover:text-destructive",onClick:A=>f(A,x.id),children:e.jsx(pe,{className:"h-3 w-3"})})]},x.id))})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(me,{placeholder:"Add a new subtask...",value:a,onChange:x=>i(x.target.value),onKeyPress:y,onClick:x=>x.stopPropagation(),className:"flex-1"}),e.jsx(P,{size:"icon",onClick:u,disabled:!a.trim(),children:e.jsx(Ks,{className:"h-4 w-4"})})]})]})})})]})}function da({task:t,onEdit:s,onDelete:r,onToggleStatus:l,onTogglePriority:a,onStartTimer:i,assignedProfiles:d}){const[h,m]=n.useState(!1),[c,u]=n.useState(!1),[p,f]=n.useState(!1),{commentCounts:y}=ie(),{trackingTask:v,isTracking:S,startTracking:x,stopTracking:A,getFormattedTime:F}=vs(),H=(v==null?void 0:v.id)===t.id,R=t.status==="completed",I=t.dueDate&&new Date(t.dueDate)<new Date&&!R,b=t.lastCommentedAt&&Date.now()-new Date(t.lastCommentedAt).getTime()<5*60*1e3&&!p,N=()=>{r(t.id),m(!1)},O=w=>{const k=new Date(w),q=new Date,$=k.getTime()-q.getTime(),U=Math.ceil($/(1e3*60*60*24));return U===0?"Today":U===1?"Tomorrow":U===-1?"Yesterday":U<0?`${Math.abs(U)} days ago`:`${U} days`},X=w=>{const k=Math.floor(w/3600),q=Math.floor(w%3600/60);return k>0?`${k}h ${q}m`:`${q}m`},C=y[t.id]||0;return e.jsxs("div",{className:"flex flex-col mb-3",children:[e.jsxs(Te,{className:M("relative transition-all duration-200 cursor-pointer","min-h-[120px] shadow-md hover:shadow-lg dark:shadow-lg","bg-white dark:bg-gray-900","border border-border/50 dark:border-gray-700","rounded-xl",R&&"opacity-75 bg-muted/50 dark:bg-gray-800",H&&"ring-2 ring-primary/50 border-primary/50",b&&"border-l-4 border-l-blue-500 bg-blue-50/10 dark:bg-blue-900/10 animate-pulse-glow",I&&"bg-destructive/5 dark:bg-red-900/20 animate-pulse-glow-destructive"),onClick:w=>{const k=w.target;(w.target===w.currentTarget||!k.closest("button, a, [role='menuitem']"))&&s(t)},children:[e.jsx("div",{className:"p-5 pb-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(P,{onClick:w=>{w.stopPropagation(),l(t.id)},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 min-w-[40px] shrink-0 rounded-full hover:bg-primary/10 transition-all",children:R?e.jsx(Ee,{className:"h-6 w-6 text-green-600"}):e.jsx(tt,{className:"h-6 w-6 text-muted-foreground hover:text-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h3",{className:M("font-semibold text-lg leading-relaxed line-clamp-2",R&&"line-through text-muted-foreground"),children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs(P,{onClick:w=>{w.stopPropagation(),u(!c),f(!0)},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-primary/10 transition-all relative",children:[e.jsx(Ae,{className:"h-5 w-5 text-muted-foreground"}),C>0&&e.jsx(K,{variant:"destructive",className:"absolute -top-1 -right-1 h-4 w-4 flex items-center justify-center p-0 text-xs font-bold",children:C})]}),e.jsx(P,{onClick:w=>{w.stopPropagation(),a(t.id)},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-yellow-500/10 transition-all",children:t.priority==="high"?e.jsx(ut,{className:"h-5 w-5 fill-yellow-400 text-yellow-400"}):e.jsx(dt,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs(Ce,{children:[e.jsx(De,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-muted/50 transition-all",onClick:w=>w.stopPropagation(),children:e.jsx(ct,{className:"h-5 w-5"})})}),e.jsxs(Se,{align:"end",className:"w-52 shadow-lg",children:[e.jsxs(Y,{onClick:w=>{w.stopPropagation(),s(t)},children:[e.jsx(Me,{className:"h-4 w-4 mr-3"}),"Edit Task"]}),e.jsx(Y,{onClick:w=>{w.stopPropagation(),i(t.id)},children:H?e.jsxs(e.Fragment,{children:[" ",e.jsx(st,{className:"h-4 w-4 mr-3"})," Stop Timer "]}):e.jsxs(e.Fragment,{children:[" ",e.jsx(rt,{className:"h-4 w-4 mr-3"})," Start Timer "]})}),e.jsxs(Y,{onClick:w=>{w.stopPropagation(),m(!0)},className:"text-destructive",children:[e.jsx(pe,{className:"h-4 w-4 mr-3"}),"Delete Task"]})]})]})]})]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 leading-relaxed",children:t.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs mt-3",children:[t.dueDate&&e.jsxs(K,{variant:I?"destructive":"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(at,{className:"h-3 w-3 mr-1.5"}),O(t.dueDate)]}),t.estimatedTime&&e.jsxs(K,{variant:"secondary",className:"h-6 text-xs px-2 py-1",children:[e.jsx(fe,{className:"h-3 w-3 mr-1.5"}),t.estimatedTime,"m"]}),t.timeSpent&&t.timeSpent>0&&e.jsxs(K,{variant:"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(fe,{className:"h-3 w-3 mr-1.5"}),X(t.timeSpent)]}),d.length>0&&e.jsxs(K,{variant:"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(nt,{className:"h-3 w-3 mr-1.5"}),d.length]}),e.jsx(K,{variant:t.status==="completed"?"default":"secondary",className:"h-6 text-xs px-2 py-1",children:t.status})]})]})]})}),e.jsx("div",{className:"px-5 py-0 border-t border-border/30",children:e.jsx(Kt,{taskId:t.id,isExpanded:c,onToggleExpanded:()=>u(!c)})}),t.subtasks&&(t.subtasks.length>0||!R)&&e.jsxs("div",{className:"px-5 pt-3 py-0 border-t border-border/30",children:[" ",e.jsx(Vt,{task:t})]}),H&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full animate-pulse shadow-glow"})})]}),e.jsx(Ot,{open:h,onOpenChange:m,onConfirm:N,itemName:t.title})]})}const ua=n.memo(function({task:s,onEdit:r,onDelete:l,onToggleStatus:a,onTogglePriority:i,onStartTimer:d,assignedProfiles:h=[],isTimeTracking:m=!1}){const[c,u]=n.useState(!1),[p,f]=n.useState(!1),[y,v]=n.useState(!1),{commentCounts:S}=ie(),{impact:x,notification:A}=Ss(),F=Ds({onSwipeLeft:()=>{x("medium"),u(!0)},onSwipeRight:()=>{x("light"),a(s.id)}},{threshold:60,velocityThreshold:.15,ignoreTapFromInteractive:!0}),H=s.dueDate&&new Date(s.dueDate)<new Date&&s.status!=="completed",R=s.status==="completed",I=s.lastCommentedAt&&Date.now()-new Date(s.lastCommentedAt).getTime()<5*60*1e3&&!y,b=()=>{l(s.id),A("error"),u(!1)},N=C=>{const w=new Date(C),k=new Date,q=w.getTime()-k.getTime(),$=Math.ceil(q/(1e3*60*60*24));return $===0?"Today":$===1?"Tomorrow":$===-1?"Yesterday":$<0?`${Math.abs($)} days ago`:`${$} days`},O=C=>{const w=Math.floor(C/3600),k=Math.floor(C%3600/60);return w>0?`${w}h ${k}m`:`${k}m`},X=S[s.id]||0;return e.jsxs("div",{className:"flex flex-col mb-3",children:[e.jsxs(Te,{ref:F,className:M("relative transition-all duration-200 touch-manipulation touch-pan-y z-10 mx-1","min-h-[100px] shadow-md hover:shadow-lg",R&&"opacity-75 bg-muted/50",H&&!R&&"border-destructive/50 bg-destructive/5",m&&"ring-2 ring-primary/50 border-primary/50",I&&"border-l-4 border-l-blue-500 bg-blue-50/10 dark:bg-blue-900/10 animate-pulse-glow","border border-border/50 rounded-xl"),children:[e.jsx("div",{className:"p-4 sm:p-5 pb-4",onClick:C=>{const w=C.target;(C.target===C.currentTarget||!w.closest('button, a, [role="menuitem"]'))&&r(s)},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(P,{onClick:C=>{C.stopPropagation(),a(s.id),x("light")},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 min-w-[40px] shrink-0 rounded-full hover:bg-primary/10 transition-all",children:R?e.jsx(Ee,{className:"h-6 w-6 text-green-600"}):e.jsx(tt,{className:"h-6 w-6 text-muted-foreground hover:text-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h3",{className:M("font-semibold text-base leading-relaxed line-clamp-2",R&&"line-through text-muted-foreground"),children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs(P,{onClick:C=>{C.stopPropagation(),f(!p),v(!0),x("light")},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-primary/10 transition-all relative",children:[e.jsx(Ae,{className:"h-5 w-5 text-muted-foreground"}),X>0&&e.jsx(K,{variant:"destructive",className:"absolute -top-1 -right-1 h-4 w-4 flex items-center justify-center p-0 text-xs font-bold",children:X})]}),e.jsx(P,{onClick:C=>{C.stopPropagation(),i(s.id),x("light")},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-yellow-500/10 transition-all",children:s.priority==="high"?e.jsx(ut,{className:"h-5 w-5 fill-yellow-400 text-yellow-400"}):e.jsx(dt,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs(Ce,{children:[e.jsx(De,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-muted/50 transition-all",onClick:C=>{C.stopPropagation(),x("light")},children:e.jsx(ct,{className:"h-5 w-5"})})}),e.jsxs(Se,{align:"end",className:"w-52 shadow-lg",children:[e.jsxs(Y,{onClick:C=>{C.stopPropagation(),r(s)},children:[e.jsx(Me,{className:"h-4 w-4 mr-3"}),"Edit Task"]}),d&&e.jsx(Y,{onClick:C=>{C.stopPropagation(),d(s.id)},children:m?e.jsxs(e.Fragment,{children:[e.jsx(st,{className:"h-4 w-4 mr-3"}),"Stop Timer"]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"h-4 w-4 mr-3"}),"Start Timer"]})}),e.jsxs(Y,{onClick:C=>{C.stopPropagation(),u(!0)},className:"text-destructive",children:[e.jsx(pe,{className:"h-4 w-4 mr-3"}),"Delete Task"]})]})]})]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 leading-relaxed",children:s.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs mt-3",children:[s.dueDate&&e.jsxs(K,{variant:H?"destructive":"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(at,{className:"h-3 w-3 mr-1.5"}),N(s.dueDate)]}),s.estimatedTime&&e.jsxs(K,{variant:"secondary",className:"h-6 text-xs px-2 py-1",children:[e.jsx(fe,{className:"h-3 w-3 mr-1.5"}),s.estimatedTime,"m"]}),s.timeSpent&&s.timeSpent>0&&e.jsxs(K,{variant:"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(fe,{className:"h-3 w-3 mr-1.5"}),O(s.timeSpent)]}),h.length>0&&e.jsxs(K,{variant:"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(nt,{className:"h-3 w-3 mr-1.5"}),h.length]}),e.jsx(K,{variant:s.status==="completed"?"default":"secondary",className:"h-6 text-xs px-2 py-1",children:s.status})]})]})]})}),e.jsx("div",{className:"px-4 py-0 border-t border-border/30",children:e.jsx(Kt,{taskId:s.id,isExpanded:p,onToggleExpanded:()=>f(!p)})}),s.subtasks&&(s.subtasks.length>0||!R)&&e.jsxs("div",{className:"px-4 pt-3 py-0 border-t border-border/30",children:[" ",e.jsx(Vt,{task:s})]}),m&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full animate-pulse shadow-glow"})})]}),e.jsx(Ot,{open:c,onOpenChange:u,onConfirm:b,itemName:s.title})]})});var He=1,Tr=.9,Er=.8,Ar=.17,ye=.1,je=.999,Mr=.9999,Rr=.99,Pr=/[\\\/_+.#"@\[\(\{&]/,Ir=/[\\\/_+.#"@\[\(\{&]/g,kr=/[\s-]/,Ht=/[\s-]/g;function we(t,s,r,l,a,i,d){if(i===s.length)return a===t.length?He:Rr;var h=`${a},${i}`;if(d[h]!==void 0)return d[h];for(var m=l.charAt(i),c=r.indexOf(m,a),u=0,p,f,y,v;c>=0;)p=we(t,s,r,l,c+1,i+1,d),p>u&&(c===a?p*=He:Pr.test(t.charAt(c-1))?(p*=Er,y=t.slice(a,c-1).match(Ir),y&&a>0&&(p*=Math.pow(je,y.length))):kr.test(t.charAt(c-1))?(p*=Tr,v=t.slice(a,c-1).match(Ht),v&&a>0&&(p*=Math.pow(je,v.length))):(p*=Ar,a>0&&(p*=Math.pow(je,c-a))),t.charAt(c)!==s.charAt(i)&&(p*=Mr)),(p<ye&&r.charAt(c-1)===l.charAt(i+1)||l.charAt(i+1)===l.charAt(i)&&r.charAt(c-1)!==l.charAt(i))&&(f=we(t,s,r,l,c+1,i+2,d),f*ye>p&&(p=f*ye)),p>u&&(u=p),c=r.indexOf(m,c+1);return d[h]=u,u}function Ue(t){return t.toLowerCase().replace(Ht," ")}function $r(t,s,r){return t=r&&r.length>0?`${t+" "+r.join(" ")}`:t,we(t,s,Ue(t),Ue(s),0,0,{})}var ne='[cmdk-group=""]',be='[cmdk-group-items=""]',_r='[cmdk-group-heading=""]',Ut='[cmdk-item=""]',Xe=`${Ut}:not([aria-disabled="true"])`,Ne="cmdk-item-select",te="data-value",Fr=(t,s,r)=>$r(t,s,r),Xt=n.createContext(void 0),oe=()=>n.useContext(Xt),qt=n.createContext(void 0),Re=()=>n.useContext(qt),Gt=n.createContext(void 0),Yt=n.forwardRef((t,s)=>{let r=se(()=>{var o,j;return{search:"",value:(j=(o=t.value)!=null?o:t.defaultValue)!=null?j:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),l=se(()=>new Set),a=se(()=>new Map),i=se(()=>new Map),d=se(()=>new Set),h=Bt(t),{label:m,children:c,value:u,onValueChange:p,filter:f,shouldFilter:y,loop:v,disablePointerSelection:S=!1,vimBindings:x=!0,...A}=t,F=re(),H=re(),R=re(),I=n.useRef(null),b=Yr();Q(()=>{if(u!==void 0){let o=u.trim();r.current.value=o,N.emit()}},[u]),Q(()=>{b(6,q)},[]);let N=n.useMemo(()=>({subscribe:o=>(d.current.add(o),()=>d.current.delete(o)),snapshot:()=>r.current,setState:(o,j,D)=>{var g,T,E,z;if(!Object.is(r.current[o],j)){if(r.current[o]=j,o==="search")k(),C(),b(1,w);else if(o==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let _=document.getElementById(R);_?_.focus():(g=document.getElementById(F))==null||g.focus()}if(b(7,()=>{var _;r.current.selectedItemId=(_=$())==null?void 0:_.id,N.emit()}),D||b(5,q),((T=h.current)==null?void 0:T.value)!==void 0){let _=j??"";(z=(E=h.current).onValueChange)==null||z.call(E,_);return}}N.emit()}},emit:()=>{d.current.forEach(o=>o())}}),[]),O=n.useMemo(()=>({value:(o,j,D)=>{var g;j!==((g=i.current.get(o))==null?void 0:g.value)&&(i.current.set(o,{value:j,keywords:D}),r.current.filtered.items.set(o,X(j,D)),b(2,()=>{C(),N.emit()}))},item:(o,j)=>(l.current.add(o),j&&(a.current.has(j)?a.current.get(j).add(o):a.current.set(j,new Set([o]))),b(3,()=>{k(),C(),r.current.value||w(),N.emit()}),()=>{i.current.delete(o),l.current.delete(o),r.current.filtered.items.delete(o);let D=$();b(4,()=>{k(),(D==null?void 0:D.getAttribute("id"))===o&&w(),N.emit()})}),group:o=>(a.current.has(o)||a.current.set(o,new Set),()=>{i.current.delete(o),a.current.delete(o)}),filter:()=>h.current.shouldFilter,label:m||t["aria-label"],getDisablePointerSelection:()=>h.current.disablePointerSelection,listId:F,inputId:R,labelId:H,listInnerRef:I}),[]);function X(o,j){var D,g;let T=(g=(D=h.current)==null?void 0:D.filter)!=null?g:Fr;return o?T(o,r.current.search,j):0}function C(){if(!r.current.search||h.current.shouldFilter===!1)return;let o=r.current.filtered.items,j=[];r.current.filtered.groups.forEach(g=>{let T=a.current.get(g),E=0;T.forEach(z=>{let _=o.get(z);E=Math.max(_,E)}),j.push([g,E])});let D=I.current;U().sort((g,T)=>{var E,z;let _=g.getAttribute("id"),ce=T.getAttribute("id");return((E=o.get(ce))!=null?E:0)-((z=o.get(_))!=null?z:0)}).forEach(g=>{let T=g.closest(be);T?T.appendChild(g.parentElement===T?g:g.closest(`${be} > *`)):D.appendChild(g.parentElement===D?g:g.closest(`${be} > *`))}),j.sort((g,T)=>T[1]-g[1]).forEach(g=>{var T;let E=(T=I.current)==null?void 0:T.querySelector(`${ne}[${te}="${encodeURIComponent(g[0])}"]`);E==null||E.parentElement.appendChild(E)})}function w(){let o=U().find(D=>D.getAttribute("aria-disabled")!=="true"),j=o==null?void 0:o.getAttribute(te);N.setState("value",j||void 0)}function k(){var o,j,D,g;if(!r.current.search||h.current.shouldFilter===!1){r.current.filtered.count=l.current.size;return}r.current.filtered.groups=new Set;let T=0;for(let E of l.current){let z=(j=(o=i.current.get(E))==null?void 0:o.value)!=null?j:"",_=(g=(D=i.current.get(E))==null?void 0:D.keywords)!=null?g:[],ce=X(z,_);r.current.filtered.items.set(E,ce),ce>0&&T++}for(let[E,z]of a.current)for(let _ of z)if(r.current.filtered.items.get(_)>0){r.current.filtered.groups.add(E);break}r.current.filtered.count=T}function q(){var o,j,D;let g=$();g&&(((o=g.parentElement)==null?void 0:o.firstChild)===g&&((D=(j=g.closest(ne))==null?void 0:j.querySelector(_r))==null||D.scrollIntoView({block:"nearest"})),g.scrollIntoView({block:"nearest"}))}function $(){var o;return(o=I.current)==null?void 0:o.querySelector(`${Ut}[aria-selected="true"]`)}function U(){var o;return Array.from(((o=I.current)==null?void 0:o.querySelectorAll(Xe))||[])}function ge(o){let j=U()[o];j&&N.setState("value",j.getAttribute(te))}function ve(o){var j;let D=$(),g=U(),T=g.findIndex(z=>z===D),E=g[T+o];(j=h.current)!=null&&j.loop&&(E=T+o<0?g[g.length-1]:T+o===g.length?g[0]:g[T+o]),E&&N.setState("value",E.getAttribute(te))}function Pe(o){let j=$(),D=j==null?void 0:j.closest(ne),g;for(;D&&!g;)D=o>0?qr(D,ne):Gr(D,ne),g=D==null?void 0:D.querySelector(Xe);g?N.setState("value",g.getAttribute(te)):ve(o)}let Ie=()=>ge(U().length-1),ke=o=>{o.preventDefault(),o.metaKey?Ie():o.altKey?Pe(1):ve(1)},$e=o=>{o.preventDefault(),o.metaKey?ge(0):o.altKey?Pe(-1):ve(-1)};return n.createElement(J.div,{ref:s,tabIndex:-1,...A,"cmdk-root":"",onKeyDown:o=>{var j;(j=A.onKeyDown)==null||j.call(A,o);let D=o.nativeEvent.isComposing||o.keyCode===229;if(!(o.defaultPrevented||D))switch(o.key){case"n":case"j":{x&&o.ctrlKey&&ke(o);break}case"ArrowDown":{ke(o);break}case"p":case"k":{x&&o.ctrlKey&&$e(o);break}case"ArrowUp":{$e(o);break}case"Home":{o.preventDefault(),ge(0);break}case"End":{o.preventDefault(),Ie();break}case"Enter":{o.preventDefault();let g=$();if(g){let T=new Event(Ne);g.dispatchEvent(T)}}}}},n.createElement("label",{"cmdk-label":"",htmlFor:O.inputId,id:O.labelId,style:Wr},m),xe(t,o=>n.createElement(qt.Provider,{value:N},n.createElement(Xt.Provider,{value:O},o))))}),Or=n.forwardRef((t,s)=>{var r,l;let a=re(),i=n.useRef(null),d=n.useContext(Gt),h=oe(),m=Bt(t),c=(l=(r=m.current)==null?void 0:r.forceMount)!=null?l:d==null?void 0:d.forceMount;Q(()=>{if(!c)return h.item(a,d==null?void 0:d.id)},[c]);let u=Wt(a,i,[t.value,t.children,i],t.keywords),p=Re(),f=B(b=>b.value&&b.value===u.current),y=B(b=>c||h.filter()===!1?!0:b.search?b.filtered.items.get(a)>0:!0);n.useEffect(()=>{let b=i.current;if(!(!b||t.disabled))return b.addEventListener(Ne,v),()=>b.removeEventListener(Ne,v)},[y,t.onSelect,t.disabled]);function v(){var b,N;S(),(N=(b=m.current).onSelect)==null||N.call(b,u.current)}function S(){p.setState("value",u.current,!0)}if(!y)return null;let{disabled:x,value:A,onSelect:F,forceMount:H,keywords:R,...I}=t;return n.createElement(J.div,{ref:le(i,s),...I,id:a,"cmdk-item":"",role:"option","aria-disabled":!!x,"aria-selected":!!f,"data-disabled":!!x,"data-selected":!!f,onPointerMove:x||h.getDisablePointerSelection()?void 0:S,onClick:x?void 0:v},t.children)}),Lr=n.forwardRef((t,s)=>{let{heading:r,children:l,forceMount:a,...i}=t,d=re(),h=n.useRef(null),m=n.useRef(null),c=re(),u=oe(),p=B(y=>a||u.filter()===!1?!0:y.search?y.filtered.groups.has(d):!0);Q(()=>u.group(d),[]),Wt(d,h,[t.value,t.heading,m]);let f=n.useMemo(()=>({id:d,forceMount:a}),[a]);return n.createElement(J.div,{ref:le(h,s),...i,"cmdk-group":"",role:"presentation",hidden:p?void 0:!0},r&&n.createElement("div",{ref:m,"cmdk-group-heading":"","aria-hidden":!0,id:c},r),xe(t,y=>n.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?c:void 0},n.createElement(Gt.Provider,{value:f},y))))}),zr=n.forwardRef((t,s)=>{let{alwaysRender:r,...l}=t,a=n.useRef(null),i=B(d=>!d.search);return!r&&!i?null:n.createElement(J.div,{ref:le(a,s),...l,"cmdk-separator":"",role:"separator"})}),Kr=n.forwardRef((t,s)=>{let{onValueChange:r,...l}=t,a=t.value!=null,i=Re(),d=B(c=>c.search),h=B(c=>c.selectedItemId),m=oe();return n.useEffect(()=>{t.value!=null&&i.setState("search",t.value)},[t.value]),n.createElement(J.input,{ref:s,...l,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":m.listId,"aria-labelledby":m.labelId,"aria-activedescendant":h,id:m.inputId,type:"text",value:a?t.value:d,onChange:c=>{a||i.setState("search",c.target.value),r==null||r(c.target.value)}})}),Vr=n.forwardRef((t,s)=>{let{children:r,label:l="Suggestions",...a}=t,i=n.useRef(null),d=n.useRef(null),h=B(c=>c.selectedItemId),m=oe();return n.useEffect(()=>{if(d.current&&i.current){let c=d.current,u=i.current,p,f=new ResizeObserver(()=>{p=requestAnimationFrame(()=>{let y=c.offsetHeight;u.style.setProperty("--cmdk-list-height",y.toFixed(1)+"px")})});return f.observe(c),()=>{cancelAnimationFrame(p),f.unobserve(c)}}},[]),n.createElement(J.div,{ref:le(i,s),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":h,"aria-label":l,id:m.listId},xe(t,c=>n.createElement("div",{ref:le(d,m.listInnerRef),"cmdk-list-sizer":""},c)))}),Hr=n.forwardRef((t,s)=>{let{open:r,onOpenChange:l,overlayClassName:a,contentClassName:i,container:d,...h}=t;return n.createElement(Qe,{open:r,onOpenChange:l},n.createElement(Je,{container:d},n.createElement(Ge,{"cmdk-overlay":"",className:a}),n.createElement(Be,{"aria-label":t.label,"cmdk-dialog":"",className:i},n.createElement(Yt,{ref:s,...h}))))}),Ur=n.forwardRef((t,s)=>B(r=>r.filtered.count===0)?n.createElement(J.div,{ref:s,...t,"cmdk-empty":"",role:"presentation"}):null),Xr=n.forwardRef((t,s)=>{let{progress:r,children:l,label:a="Loading...",...i}=t;return n.createElement(J.div,{ref:s,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},xe(t,d=>n.createElement("div",{"aria-hidden":!0},d)))}),L=Object.assign(Yt,{List:Vr,Item:Or,Input:Kr,Group:Lr,Separator:zr,Dialog:Hr,Empty:Ur,Loading:Xr});function qr(t,s){let r=t.nextElementSibling;for(;r;){if(r.matches(s))return r;r=r.nextElementSibling}}function Gr(t,s){let r=t.previousElementSibling;for(;r;){if(r.matches(s))return r;r=r.previousElementSibling}}function Bt(t){let s=n.useRef(t);return Q(()=>{s.current=t}),s}var Q=typeof window>"u"?n.useEffect:n.useLayoutEffect;function se(t){let s=n.useRef();return s.current===void 0&&(s.current=t()),s}function B(t){let s=Re(),r=()=>t(s.snapshot());return n.useSyncExternalStore(s.subscribe,r,r)}function Wt(t,s,r,l=[]){let a=n.useRef(),i=oe();return Q(()=>{var d;let h=(()=>{var c;for(let u of r){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():a.current}})(),m=l.map(c=>c.trim());i.value(t,h,m),(d=s.current)==null||d.setAttribute(te,h),a.current=h}),a}var Yr=()=>{let[t,s]=n.useState(),r=se(()=>new Map);return Q(()=>{r.current.forEach(l=>l()),r.current=new Map},[t]),(l,a)=>{r.current.set(l,a),s({})}};function Br(t){let s=t.type;return typeof s=="function"?s(t.props):"render"in s?s.render(t.props):t}function xe({asChild:t,children:s},r){return t&&n.isValidElement(s)?n.cloneElement(Br(s),{ref:s.ref},r(s.props.children)):r(s)}var Wr={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Jt=n.forwardRef(({className:t,...s},r)=>e.jsx(L,{ref:r,className:M("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...s}));Jt.displayName=L.displayName;const Qt=n.forwardRef(({className:t,...s},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(ys,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(L.Input,{ref:r,className:M("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...s})]}));Qt.displayName=L.Input.displayName;const Zt=n.forwardRef(({className:t,...s},r)=>e.jsx(L.List,{ref:r,className:M("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...s}));Zt.displayName=L.List.displayName;const es=n.forwardRef((t,s)=>e.jsx(L.Empty,{ref:s,className:"py-6 text-center text-sm",...t}));es.displayName=L.Empty.displayName;const ts=n.forwardRef(({className:t,...s},r)=>e.jsx(L.Group,{ref:r,className:M("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...s}));ts.displayName=L.Group.displayName;const Jr=n.forwardRef(({className:t,...s},r)=>e.jsx(L.Separator,{ref:r,className:M("-mx-1 h-px bg-border",t),...s}));Jr.displayName=L.Separator.displayName;const ss=n.forwardRef(({className:t,...s},r)=>e.jsx(L.Item,{ref:r,className:M("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",t),...s}));ss.displayName=L.Item.displayName;function Qr({options:t,selected:s,onChange:r,placeholder:l="Select items...",label:a,className:i}){const[d,h]=n.useState(!1),m=u=>{r(s.filter(p=>p!==u))},c=u=>{s.includes(u)?r(s.filter(p=>p!==u)):r([...s,u])};return e.jsxs("div",{className:M("grid gap-2",i),children:[a&&e.jsx("label",{className:"text-sm font-medium",children:a}),e.jsxs(js,{open:d,onOpenChange:h,children:[e.jsx(bs,{asChild:!0,children:e.jsxs(P,{variant:"outline",role:"combobox","aria-expanded":d,className:"w-full justify-between text-left font-normal",onClick:()=>h(!d),children:[e.jsx("div",{className:"flex gap-1 flex-wrap",children:s.length>0?s.map(u=>{const p=t.find(f=>f.value===u);return e.jsxs(K,{variant:"secondary",className:"mr-1 mb-1",onClick:f=>{f.preventDefault(),f.stopPropagation(),m(u)},children:[p==null?void 0:p.label,e.jsx("button",{className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onKeyDown:f=>{f.key==="Enter"&&m(u)},onMouseDown:f=>{f.preventDefault(),f.stopPropagation()},onClick:f=>{f.preventDefault(),f.stopPropagation(),m(u)},children:e.jsx(et,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})})]},u)}):e.jsx("span",{className:"text-muted-foreground",children:l})}),e.jsx(Hs,{className:"h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ws,{className:"w-full p-0",children:e.jsxs(Jt,{children:[e.jsx(Qt,{placeholder:"Search..."}),e.jsx(es,{children:"No item found."}),e.jsx(ts,{children:e.jsx(Zt,{children:t.map(u=>e.jsxs(ss,{onSelect:()=>c(u.value),children:[e.jsx(Ns,{className:M("mr-2 h-4 w-4",s.includes(u.value)?"opacity-100":"opacity-0")}),u.label]},u.value))})})]})})]})]})}function Zr({members:t,selectedIds:s,onSelectionChange:r,label:l="Assigned Members",placeholder:a="Select team members"}){const i=t.map(d=>({label:d.displayName||d.email,value:d.uid}));return e.jsx(Qr,{options:i,selected:s,onChange:r,label:l,placeholder:a})}function ma({task:t,onSubmit:s,onCancel:r,teamMembers:l}){var h;const[a,i]=n.useState({title:(t==null?void 0:t.title)||"",description:(t==null?void 0:t.description)||"",priority:(t==null?void 0:t.priority)||"medium",status:(t==null?void 0:t.status)||"todo",estimatedTime:((h=t==null?void 0:t.estimatedTime)==null?void 0:h.toString())||"",dueDate:(t==null?void 0:t.dueDate)||"",assignedTo:(t==null?void 0:t.assignedTo)||[]}),d=m=>{m.preventDefault(),s({...a,estimatedTime:a.estimatedTime?parseInt(a.estimatedTime,10):void 0,assignedTo:a.assignedTo})};return e.jsxs("form",{onSubmit:d,className:"space-y-6 py-4",children:[e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"title",className:"text-sm font-medium",children:"Title *"}),e.jsx(me,{id:"title",value:a.title,onChange:m=>i({...a,title:m.target.value}),placeholder:"Enter task title",className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20",required:!0})]}),e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),e.jsx(lt,{id:"description",value:a.description,onChange:m=>i({...a,description:m.target.value}),placeholder:"Enter task description",className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"priority",className:"text-sm font-medium",children:"Priority"}),e.jsxs(Oe,{value:a.priority,onValueChange:m=>i({...a,priority:m}),children:[e.jsx(Le,{className:"mt-2",children:e.jsx(ze,{})}),e.jsxs(Ke,{children:[e.jsx(ee,{value:"low",children:"Low"}),e.jsx(ee,{value:"medium",children:"Medium"}),e.jsx(ee,{value:"high",children:"High"})]})]})]}),e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"status",className:"text-sm font-medium",children:"Status"}),e.jsxs(Oe,{value:a.status,onValueChange:m=>i({...a,status:m}),children:[e.jsx(Le,{className:"mt-2",children:e.jsx(ze,{})}),e.jsxs(Ke,{children:[e.jsx(ee,{value:"todo",children:"To Do"}),e.jsx(ee,{value:"in-progress",children:"In Progress"}),e.jsx(ee,{value:"completed",children:"Completed"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"estimatedTime",className:"text-sm font-medium",children:"Estimated Time (minutes)"}),e.jsx(me,{id:"estimatedTime",type:"number",value:a.estimatedTime,onChange:m=>i({...a,estimatedTime:m.target.value}),placeholder:"25",className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20",min:"1"})]}),e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"dueDate",className:"text-sm font-medium",children:"Due Date"}),e.jsx(me,{id:"dueDate",type:"datetime-local",value:a.dueDate,onChange:m=>i({...a,dueDate:m.target.value}),className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20"})]})]}),l.length>0&&e.jsx("div",{children:e.jsx(Zr,{members:l,selectedIds:a.assignedTo,onSelectionChange:m=>i({...a,assignedTo:m})})}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx(P,{type:"submit",variant:"focus",className:"flex-1",children:t?"Update Task":"Create Task"}),e.jsx(P,{type:"button",variant:"outline",onClick:r,className:"hover-scale",children:"Cancel"})]})]})}export{zt as A,ua as M,da as T,ma as a};
